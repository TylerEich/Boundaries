{"version":3,"file":"status/status.js","names":[],"mappings":"","sources":["status/status.js"],"sourcesContent":["/* jshint camelcase: false */\n\nangular.module('bndry.status', ['bndry.map', 'bndry.geo'])\n  .directive('statusBar', function($interval) {\n    return {\n      restrict: 'E',\n      scope: {\n        hide: '@',\n        value: '@'\n      },\n      template: '<div ng-style=\"{width: percentage()}\" style=\"height: 100%; position: absolute;\" ng-hide=\"hide\"></div>',\n      link: function(scope) {\n        var pending = 0,\n          finished = 0;\n        \n        scope.$on('load:start', () => {\n          pending++;\n        });\n        scope.$on('load:done', () => {\n          finished++;\n          if (finished >= pending) {\n            pending = 0;\n            finished = 0;\n          }\n        });\n        scope.$on('load:error', () => {\n          pending = 0;\n          finished = 0;\n        });\n        \n        scope.percentage = function() {\n          console.log(`${(finished + 1) / (pending + 1) * 100}%`);\n          return `${(finished + 1) / (pending + 1) * 100}%`;\n        }\n      }\n    };\n  })\n  .controller('StatusCtrl', function($scope, $timeout, MapSvc, GeocodeSvc) {\n    var locality = '';\n    \n    $scope.locality = function() {\n      return locality;\n    };\n\n    $scope.$on('map:idle', function() {\n      GeocodeSvc.geocode(MapSvc.map.getCenter())\n        .then(function(results) {\n          console.info(results);\n          \n          var localityOptions = [\n            'administrative_area_level_3',\n            'administrative_area_level_2',\n            'administrative_area_level_1',\n            'country'\n          ];\n          \n          locality = '';\n          results.forEach(function(result) {\n            if (locality) {\n              return;\n            }\n            \n            for (var i = 0; i < localityOptions.length; i++) {\n              if (result.types.indexOf(localityOptions[i]) > -1) {\n                locality = result.formatted_address;\n              }\n\n              if (locality) {\n                return false;\n              }\n            }\n          });\n        },\n        function() {\n          locality = 'Unknown Locality';\n        });\n    });\n  });\n"],"sourceRoot":"/source/"}