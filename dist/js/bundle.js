!function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){var n=t[a][1][e];return i(n?n:e)},d,d.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e){"use strict";var t=function(e){return e&&e.__esModule?e:{"default":e}},n=e("./map-class"),r=e("./directives/territory-editor-dir"),i=(t(r),e("./map-view")),o=t(i);angular.module("bndry",[]),window.mapCanvas=new n.MapCanvas(document.querySelector("#map_canvas"),{center:{lat:41.123728,lng:-84.864721},zoom:17,disableDefaultUI:!0}),window.mapView=new o["default"](window.mapCanvas)},{"./directives/territory-editor-dir":4,"./map-class":7,"./map-view":8}],2:[function(e,t,n){"use strict";function r(e){var t=void 0===arguments[1]?"Assertion failed":arguments[1];if(!e){if("undefined"!=typeof Error)throw new Error(t);throw t}}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r,t.exports=n["default"]},{}],3:[function(e,t,n){"use strict";function r(e){return v["default"](e instanceof m.Point),new b.LatLng(e.y,e.x)}function i(e){return v["default"]("function"==typeof e.lat&&"function"==typeof e.lng),new m.Point(e.lng(),e.lat())}function o(e){}function a(e){}function s(e){return}function u(e){return}var l=function(e){return e&&e.__esModule?e:{"default":e}},d=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var c=e("../assert"),v=l(c),h=e("../pubsub"),g=e("../event-target"),p=(l(g),e("../queue")),y=l(p),m=e("../drawing-class"),b=e("../map-class"),_=e("../map-view"),w=new b.DirectionsService,x=0,D=function(){function e(){var t=this;d(this,e),this.territory=new m.Territory,this._state={createNewDrawing:!1,rigid:!1,fill:!1,color:"#ff0000",mode:x,activeDrawingIndex:-1,activeNodeIndex:-1},this.queue=new y["default"],h.on(_.MapView.event.MAP_PRESSED,function(e,n){return t.addNode(n)}),h.on(_.MapView.event.MARKER_DRAGENDED,function(e,n){return t.moveNode(n)})}return f(e,[{key:"createNewDrawing",get:function(){return this._state.createNewDrawing},set:function(e){v["default"]("boolean"==typeof e,"Value of createNewDrawing must be boolean"),this._state.createNewDrawing=e}},{key:"rigid",get:function(){return this._state.rigid},set:function(e){v["default"]("boolean"==typeof e,"Value of rigid must be boolean"),this._state.rigid=e}},{key:"fill",get:function(){return this._state.fill},set:function(e){v["default"]("boolean"==typeof e,"Value of fill must be boolean"),this._state.fill=e}},{key:"color",get:function(){return this._state.color},set:function(e){v["default"]("string"==typeof e,"Value of color must be string"),this._state.color=e}},{key:"mode",get:function(){return this._state.mode},set:function(e){v["default"](Number.isInteger(e),"Value of mode must be a constant"),this._state.mode=e}},{key:"activeDrawingIndex",get:function(){return this._state.activeDrawingIndex},set:function(e){v["default"](Number.isInteger(e),"Value of activeDrawingIndex must be integer"),this._state.activeDrawingIndex=e}},{key:"activeNodeIndex",get:function(){return this._state.activeNodeIndex},set:function(e){v["default"](Number.isInteger(e),"Value of activeNodeIndex must be integer"),this._state.activeNodeIndex=e}},{key:"addDrawing",value:function(){var e=this._state,t=e.rigid,n=e.fill,r=e.color,i=new m.Drawing({rigid:t,fill:n,color:r}),o=++this.activeDrawingIndex;this.territory.addDrawing({atIndex:o,drawing:i}),s(i)}},{key:"removeDrawing",value:function(){var e=this.activeDrawingIndex--,t=this.territory.removeDrawingAtIndex(e);u(t)}},{key:"fillPathAroundNode",value:function(e){var t,n,o,a,s,u,l,d,f,c,h,g,p,y=e.drawing,b=e.node;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(v["default"](y instanceof m.Drawing),v["default"](b instanceof m.Node),t=y.nodesAroundNode(b),n=t.start,o=t.end,y.rigid){e.next=68;break}if(n!==b||o!==b){e.next=23;break}return a=void 0,e.prev=8,e.next=11,w.route({origin:r(b),destination:r(b)});case 11:a=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](8),alert(e.t0);case 17:f=a.map(i),v["default"](f.length>0),s=f[0],u=s.x,l=s.y,this.queue.add(b.moveTo.bind(b,u,l));case 23:if(d=void 0,f=void 0,n===b){e.next=46;break}return e.prev=25,e.next=28,w.route({origin:r(n),destination:r(b)});case 28:d=e.sent,e.next=34;break;case 31:e.prev=31,e.t1=e["catch"](25),alert(e.t1);case 34:f=d.map(i),u=void 0,l=void 0,c=f.shift(),u=c.x,l=c.y,n.moveTo(u,l),h=f.pop(),u=h.x,l=h.y,b.moveTo(u,l),this.queue.add(y.removePointsBetweenNodes.bind(y,n,b)),this.queue.add(y.addPointsAfterNode.bind(y,n,f));case 46:if(o===b){e.next=68;break}return e.prev=47,e.next=50,w.route({origin:r(b),destination:r(o)});case 50:d=e.sent,e.next=56;break;case 53:e.prev=53,e.t2=e["catch"](47),alert(e.t2);case 56:f=d.map(i),u=void 0,l=void 0,g=f.shift(),u=g.x,l=g.y,b.moveTo(u,l),p=f.pop(),u=p.x,l=p.y,o.moveTo(u,l),this.queue.add(y.removePointsBetweenNodes.bind(y,b,o)),this.queue.add(y.addPointsAfterNode.bind(y,b,f));case 68:case"end":return e.stop()}},null,this,[[8,14],[25,31],[47,53]])}},{key:"addNode",value:function(e){var t=this;this.createNewDrawing&&(this.addDrawing(),this.createNewDrawing=!1);var n=this.territory.atIndex(this.activeDrawingIndex),r=++this.activeNodeIndex,i=e.latLng.lng(),a=e.latLng.lat(),s=new m.Node(i,a);this.queue.add(function(){n.addNode(s,r),t.fillPathAroundNode({drawing:n,node:s})}),o(s)}},{key:"moveNode",value:function(e){var t=this,n=e.latLng,r=e.node;v["default"](r instanceof m.Node);var o=this.territory.find(function(e){return e.indexOf(r)>-1}),a=i(n);v["default"](o instanceof m.Drawing),this.queue.add(function(){return r.moveTo(a.x,a.y),t.fillPathAroundNode({drawing:o,node:r})})}},{key:"removeNode",value:function(){var e=this;this.queue.add(function(){var t=e.territory.atIndex(e.activeDrawingIndex),n=t.removeNodeAtIndex(e.activeNodeIndex);a(n)})}},{key:"getTerritoryGeoJson",value:function(){return this.territory.toGeoJson()}},{key:"detachedCallback",value:function(){this.territory.forEach(u)}}]),e}();n["default"]=D,t.exports=n["default"]},{"../assert":2,"../drawing-class":5,"../event-target":6,"../map-class":7,"../map-view":8,"../pubsub":9,"../queue":10}],4:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("../components/territory-editor-cmp"),o=r(i);n["default"]=angular.module("bndry").directive("territoryEditor",function(){return{restrict:"E",scope:{},controller:o["default"],controllerAs:"territoryEditor",templateUrl:"../templates/territory-editor-tpl.html",bindToController:!0}}),t.exports=n["default"]},{"../components/territory-editor-cmp":3}],5:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},a=function m(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:m(i,t,n)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(n)},s=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},u=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var d=e("./pubsub"),f=e("./assert"),c=r(f),v=function(){function e(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];u(this,e),this._points=n}return l(e,[{key:"push",value:function(){for(var e,t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return(e=this._points).push.apply(e,n)}},{key:"splice",value:function(){for(var e,t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return(e=this._points).splice.apply(e,n)}},{key:"filter",value:function(e){return this._points.filter(e)}},{key:"find",value:function(e){return this._points.find(e)}},{key:"every",value:function(e){return this._points.every(e)}},{key:"some",value:function(e){return this._points.some(e)}},{key:"atIndex",value:function(e){return c["default"](e<this._points.length,"Out of bounds"),this._points[e]}},{key:"length",get:function(){return this._points.length}},{key:"indexOf",value:function(e,t){return c["default"](e instanceof h),this._points.indexOf(e,t)}},{key:"isValid",value:function(){var e=this._points;return 0===e.length||e[e.length-1]instanceof g&&e[0]instanceof g}}]),e}(),h=function(){function e(t,n){u(this,e),c["default"]("number"==typeof t),c["default"]("number"==typeof n),this._x=t,this._y=n}return l(e,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"lat",get:function(){return this._y}},{key:"lng",get:function(){return this._x}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),g=function(e){function t(e,n){u(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n)}return s(t,e),l(t,[{key:"moveTo",value:function(e,n){c["default"]("number"==typeof e,"X must be a number"),c["default"]("number"==typeof n,"Y must be a number"),this._x=e,this._y=n,d.emit(t.event.MOVED,{x:e,y:n,context:this})}}]),t}(h);g.event={MOVED:"Node.moved"};var p=function(e){function t(e){var n=e.color,r=e.fill,i=e.rigid;u(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),c["default"]("string"==typeof n),c["default"]("boolean"==typeof r),c["default"]("boolean"==typeof i),this._color=n,this._fill=r,this._rigid=i,c["default"](this.isValid())}return s(t,e),l(t,[{key:"isValid",value:function(){var e=a(Object.getPrototypeOf(t.prototype),"isValid",this).call(this),n=this.rigid?this.every(function(e){return e instanceof g}):!0,r=this.fill?0===this.length||this.atIndex(0)===this.atIndex(this.length-1):!0;return e&&n&&r}},{key:"color",get:function(){return this._color},set:function(e){c["default"]("string"==typeof e),this._color=e,d.emit(t.event.COLOR_CHANGED,{color:e,context:this})}},{key:"fill",get:function(){return this._fill},set:function(e){c["default"]("boolean"==typeof e);var n=this.fill;this._fill=e,e!==n&&(e&&this.length>0?this._addPoints({atIndex:this.length,points:[this.atIndex(0)]}):e||this.removeNode(this.atIndex(this.length-1))),d.emit(t.event.FILL_CHANGED,{fill:e,context:this})}},{key:"rigid",get:function(){return this._rigid},set:function(e){c["default"]("boolean"==typeof e);var n=this.rigid;if(this._rigid=e,e&&e!==n)for(var r=0;r<this.length;r++)this.atIndex(r)instanceof g||this.splice(r,1);d.emit(t.event.RIGID_CHANGED,{rigid:e,context:this})}},{key:"nodesAroundNode",value:function(e){var t=this.nodes(),n=t.indexOf(e),r=this._nodeIndicesAroundNodeIndex(n),i=r.start,o=r.end,a=r.hasFirst,s=r.hasLast;return{start:this.atIndex(i),end:this.atIndex(o),hasFirst:a,hasLast:s}}},{key:"_nodeIndicesAroundNodeIndex",value:function(e){var t=void 0,n=void 0,r=!1,i=!1,o=this.nodePositions();return c["default"](e>=0&&e<o.length),0!==e||this.fill?0===e&&this.fill?(c["default"](o.length>=2),t=o[o.length-2]):t=o[e-1]:(t=o[e],r=!0),e!==o.length-1||this.fill?n=o[e+1]:(n=o[e],i=!0),{start:t,end:n,hasFirst:r,hasLast:i}}},{key:"removePointsBetweenNodes",value:function(e,t){c["default"](e instanceof g),c["default"](t instanceof g);var n=this.indexOf(e),r=this.indexOf(t,n);return c["default"](n>-1,"Node not found"),c["default"](r>-1,"Node not found"),c["default"](r>=n),n++,this._removePoints({start:n,end:r})}},{key:"addPointsAfterNode",value:function(e,t){c["default"](e instanceof g),c["default"](Array.isArray(t)),c["default"](this.indexOf(e)>-1,"Node not found");var n=this.indexOf(e)+1;return this._addPoints({atIndex:n,points:t})}},{key:"addNode",value:function(e,t){var n=this.nodePositions(),r=this.length;c["default"](e instanceof g),c["default"](Number.isInteger(t)),c["default"](t>-1),n.length>0&&t>=0&&t<n.length&&(r=n[t]+1);var i=[e];0===this.length&&this.fill?i.push(e):this.fill&&r===this.length&&r--,this._addPoints({atIndex:r,points:i})}},{key:"removeNode",value:function(e){c["default"](e instanceof g);var t=this.indexOf(e),n=this.nodePositions().indexOf(t);return this.removeNodeAtIndex(n)}},{key:"removeNodeAtIndex",value:function(e){var t=this._nodeIndicesAroundNodeIndex(e),n=t.start,r=t.end,i=t.hasFirst,o=t.hasLast;i||this.fill&&!(this.length>2)||n++,(o||this.fill&&this.length<=2)&&r++;var a=this._removePoints({start:n,end:r});return a}},{key:"_removePoints",value:function(e){var n=e.start,r=e.end;c["default"](n>=0),c["default"](r<=this.length),c["default"](r>=n||this.fill);var i=0,a=[];return this.fill&&n>r&&(i=this.length-n,c["default"](i>=0),a.push.apply(a,o(this.splice(n,i))),a.pop(),this.push(this.atIndex(r)),n=0),i=r-n,a.push.apply(a,o(this.splice(n,i))),c["default"](this.isValid(),"Invalid path operation"),2===a.length&&a[0]===a[1]&&a.pop(),d.emit(t.event.POINTS_REMOVED,{start:n,end:r,removedPoints:a,context:this}),a}},{key:"_addPoints",value:function(e){var n=e.atIndex,r=e.points;c["default"](n>=0&&n<=this.length,"Out of bounds"),c["default"](Array.isArray(r),"points must be an Array"),this.splice.apply(this,[n,0].concat(o(r))),c["default"](this.isValid(),"Invalid path operation"),d.emit(t.event.POINTS_ADDED,{atIndex:n,addedPoints:r,context:this})}},{key:"pointAtIndex",value:function(e){return this.atIndex(e)}},{key:"nodePositions",value:function(){for(var e=this,t=[],n=0;n<e.length;n++){var r=e.atIndex(n);r instanceof g&&t.push(n)}return t}},{key:"points",value:function(){return this.filter(function(){return!0})}},{key:"nodes",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return t.toString()},t}(function(){var e=this.filter(function(e){return e instanceof g});return this.fill&&e.pop(),e})}]),t}(v);p.event={COLOR_CHANGED:"Drawing.colorChanged",FILL_CHANGED:"Drawing.fillChanged",RIGID_CHANGED:"Drawing.rigidChanged",POINTS_ADDED:"Drawing.pointsAdded",POINTS_REMOVED:"Drawing.pointsRemoved"};var y=function(){function e(){u(this,e),this._drawings=[],this._activeDrawingIndex=-1}return l(e,[{key:"length",get:function(){return this._drawings.length}},{key:"find",value:function(e){return this._drawings.find(e)}},{key:"atIndex",value:function(e){return c["default"](Number.isInteger(e)),c["default"](e>=0&&e<this._drawings.length),this._drawings[e]}},{key:"addDrawing",value:function(t){var n=t.atIndex,r=t.drawing;return c["default"](Number.isInteger(n)),c["default"](r instanceof p),d.emit(e.event.DRAWING_ADDED,{atIndex:n,drawing:r,context:this}),this._drawings.splice(n,0,r)}},{key:"removeDrawing",value:function(e){c["default"](e instanceof p);var t=this._drawings.indexOf(e);return c["default"](t>-1,"Drawing not found"),this.removeDrawingAtIndex(t)}},{key:"removeDrawingAtIndex",value:function(t){c["default"](t>=0&&t<this._drawings.length,"Out of bounds");var n=this._drawings.splice(t,1)[0],r=n.nodes(),i=!0,o=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;n.removeNode(l)}}catch(f){o=!0,a=f}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return d.emit(e.event.DRAWING_REMOVED,{atIndex:t,drawing:n,context:this}),n}},{key:"toGeoJson",value:function(){var e={type:"FeatureCollection"};return e.features=this._drawings.map(function(e){var t={type:"Feature"},n=e._points.map(function(e){var t=e.x,n=e.y;return[t,n]});t.geometry={type:e.fill?"Polygon":"LineString",coordinates:e.fill?[n]:n};var r=e.color,i=e.rigid,o=e.fill;return t.properties={color:r,rigid:i,fill:o},t.properties.nodePositions=e.nodePositions(),t}),e}}],[{key:"fromGeoJson",value:function(t){c["default"]("object"==typeof t);var n=new e;return c["default"](Array.isArray(t.features)),t.features.forEach(function(e){c["default"]("object"==typeof e.properties),c["default"]("object"==typeof e.geometry);var t=e.properties,r=t.color,o=t.rigid,a=t.fill,s=t.nodePositions;c["default"]("string"==typeof r),c["default"]("boolean"==typeof o),c["default"]("boolean"==typeof a),c["default"](Array.isArray(s));var u=new p({color:r,rigid:o,fill:a});n.addDrawings({atIndex:-1,drawing:u});var l=void 0;l=a?e.geometry.coordinates[0]:e.geometry.coordinates,c["default"](Array.isArray(l));var d=l.map(function(e,t){var n=i(e,2),r=n[0],o=n[1];return-1===s.indexOf(t)?new h(r,o):new g(r,o)});return u.addPoints({atIndex:0,points:d}),u}),n}}]),e}();y.event={DRAWING_ADDED:"Territory.drawingAdded",DRAWING_REMOVED:"Territory.drawingRemoved"},n.Point=h,n.Node=g,n.Drawing=p,n.Territory=y},{"./assert":2,"./pubsub":9}],6:[function(e,t,n){"use strict";function r(e,t,n){l.value=n,d(e,t,l),l.value=null}function i(e,t,n){var i;c.call(e,t)?i=e[t]:r(e,t,i=[]),f.call(i,n)<0&&i.push(n)}function o(e,t,n){var r,i,o;if(c.call(e,t))for(n.target=e,r=e[t].slice(0),o=0;o<r.length;o++)i=r[o],"function"==typeof i?i.call(e,n):"function"==typeof i.handleEvent&&i.handleEvent(n)}function a(e,t,n){var r,i;c.call(e,t)&&(r=e[t],i=f.call(r,n),i>-1&&(r.splice(i,1),r.length||delete e[t]))}Object.defineProperty(n,"__esModule",{value:!0});var s="@@",u={},l={configurable:!0,value:null},d=Object.defineProperty||function(e,t,n){e[t]=n.value},f=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},c=u.hasOwnProperty;r(u,"addEventListener",function(e,t){i(this,s+e,t)}),r(u,"dispatchEvent",function(e){o(this,s+e.type,e)}),r(u,"removeEventListener",function(e,t){a(this,s+e,t)}),n["default"]=u,t.exports=n["default"]},{}],7:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function m(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:m(i,t,n)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(n)},s=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)};Object.defineProperty(n,"__esModule",{value:!0});var u=e("./assert"),l=r(u),d=e("./pubsub"),f=google.maps.event.addListener,c=google.maps.event.clearListeners,v=function(e){function t(){for(var e=this,n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];i(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r),this._markers=[],this._polys=[],f(this,"click",function(n){return d.emit(t.event.PRESSED,{event:n,context:e})})}return s(t,e),o(t,[{key:"addMarker",value:function(e){var t=e.atIndex,n=e.marker;l["default"](Number.isInteger(t)),l["default"](t>=0&&t<=this._markers.length),l["default"](n instanceof h),n.setMap(this),this._markers.splice(t,0,n)}},{key:"removeMarker",value:function(e){l["default"](e instanceof h);var t=this._markers.indexOf(e);return l["default"](t>-1,"Poly not found"),this.removePolyAtIndex(t)}},{key:"removeMarkerAtIndex",value:function(e){l["default"](Number.isInteger(e)),l["default"](e>=0&&e<this._markers.length);var t=this._markers.splice(e,1)[0];l["default"](t instanceof h),t.destroy()}},{key:"addPoly",value:function(e){var t=e.atIndex,n=e.poly;l["default"](Number.isInteger(t)),l["default"](t>=0&&t<=this._polys.length),l["default"](n instanceof g),n.setMap(this),this._polys.splice(t,0,n)}},{key:"removePoly",value:function(e){l["default"](e instanceof g);var t=this._polys.indexOf(e);return l["default"](t>-1,"Poly not found"),this.removePolyAtIndex(t)}},{key:"removePolyAtIndex",value:function(e){l["default"](Number.isInteger(e)),l["default"](e>=0&&e<this._polys.length);var t=this._polys.splice(e,1)[0];l["default"](t instanceof g),t.destroy()}}]),t}(google.maps.Map);v.event={PRESSED:"MapCanvas.pressed"};var h=function(e){function t(){for(var e=this,n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];i(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r),f(this,"click",function(n){return d.emit(t.event.PRESSED,{event:n,context:e})}),f(this,"dragstart",function(n){return d.emit(t.event.DRAGSTARTED,{event:n,context:e})}),f(this,"drag",function(n){return d.emit(t.event.DRAGGED,{event:n,context:e})}),f(this,"dragend",function(n){return d.emit(t.event.DRAGENDED,{event:n,context:e})})}return s(t,e),o(t,[{key:"setOptions",value:function(e){l["default"]("object"==typeof e),e.color}},{key:"destroy",value:function(){c(this),this.setMap(null)}}]),t}(google.maps.Marker);h.event={PRESSED:"Marker.pressed",DRAGSTARTED:"Marker.dragstarted",DRAGGED:"Marker.dragged",DRAGENDED:"Marker.dragended"};var g=function(){function e(t){var n=this;i(this,e),l["default"]("object"==typeof t),this._poly=t.fillColor||void 0!==t.fillOpacity?new google.maps.Polygon(t):new google.maps.Polyline(t),f(this._poly,"click",function(t){return d.emit(e.event.PRESSED,{event:t,context:n})})}return o(e,[{key:"length",get:function(){return this._poly.getPath().getLength()}},{key:"setMap",value:function(e){this._poly.setMap(e)}},{key:"addLatLngs",value:function(e){var t=e.atIndex,n=e.latLngs,r=this._poly.getPath();l["default"](Number.isInteger(t)),l["default"](t>=0&&t<=r.getLength()),l["default"](Array.isArray(n)),n.forEach(function(e,n){r.insertAt(t+n,e)})}},{key:"removeLatLngs",value:function(e){var t=e.start,n=e.end,r=this._poly.getPath();l["default"](Number.isInteger(t)),l["default"](Number.isInteger(n)),l["default"](t>=0&&n>=t),l["default"](n<=r.getLength());for(var i=n-1;i>=t;i--)r.removeAt(i)}},{key:"destroy",value:function(){c(this._poly),this._poly.setMap(null)}}]),e}();g.event={PRESSED:"Poly.pressed"};var p=function(e){function t(){for(var e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];i(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,n)}return s(t,e),o(t,[{key:"route",value:function(e){var n=e.origin,r=e.destination,i=this;return l["default"](n instanceof y),l["default"](r instanceof y),new Promise(function(e,o){a(Object.getPrototypeOf(t.prototype),"route",i).call(i,{origin:n,destination:r,travelMode:google.maps.TravelMode.DRIVING},function(t,n){n===google.maps.DirectionsStatus.OK?e(t.routes[0].overview_path):o(n)})})}}]),t}(google.maps.DirectionsService),y=(function(e){function t(){i(this,t),null!=e&&e.apply(this,arguments)}return s(t,e),t}(google.maps.places.AutocompleteService),google.maps.LatLng);n.MapCanvas=v,n.Marker=h,n.Poly=g,n.LatLng=y,n.DirectionsService=p},{"./assert":2,"./pubsub":9}],8:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./assert"),a=r(o),s=e("./pubsub"),u=e("./event-target"),l=(r(u),e("./map-class")),d=e("./drawing-class"),f={event:{MAP_PRESSED:"MapView.mapPressed",POLY_PRESSED:"MapView.polyPressed",MARKER_PRESSED:"MapView.markerPressed",MARKER_DRAGSTARTED:"MapView.markerDragstart",MARKER_DRAGGED:"MapView.markerDrag",MARKER_DRAGENDED:"MapView.markerDragend"}};n.MapView=f,n["default"]=function(){function e(e){return new l.LatLng(e.y,e.x)}function t(t){return t.map(e)}function n(e){var t={clickable:!0,draggable:!1,editable:!1,geodesic:!1,visible:!0};return t.strokeOpacity=.5,t.strokeColor=e.color,e.fill?(t.fillColor=e.color,t.fillOpacity=.25,t.strokeWeight=8):t.strokeWeight=8,new l.Poly(t)}function r(e){return{fillColor:e,fillOpacity:0,path:"M-16,0 a 16,16 0 1,0 32,0a16,16 0 1,0 -32,0 M-2,0 a 2,2 0 1,0 4,0a2,2 0 1,0 -4,0",scale:1,strokeColor:e,strokeOpacity:1,strokeWeight:4}}function o(e){var t=e.point,n=e.color,i={lat:t.y,lng:t.x};return new l.Marker({clickable:!0,crossOnDrag:!1,cursor:"pointer",draggable:!0,icon:r(n),opacity:1,position:i,visible:!0})}function u(e){for(var t=e.map,n=e.searchValue,r=t.entries(),o=void 0;o=r.next();){a["default"](!o.done);var s=i(o.value,2),u=s[0],l=s[1];if(l===n)return u}}function c(e){return u({map:g,searchValue:e})}function v(e){return u({map:h,searchValue:e})}var h=new Map,g=new Map,p=new Map;window.mapCanvas.data.setStyle(function(e){var t=e.getProperty("color"),n=e.getProperty("fill");return n?{strokeColor:t,strokeOpacity:.25,strokeWeight:5,fillColor:t,fillOpacity:.25}:{strokeColor:t,strokeWeight:5}}),s.on(d.Territory.event.DRAWING_ADDED,function(e,t){var r=t.atIndex,i=t.drawing,o=(t.context,n(i));window.mapCanvas.addPoly({atIndex:r,poly:o}),h.set(i,o)}),s.on(d.Territory.event.DRAWING_REMOVED,function(e,t){var n=t.drawing,r=h.get(n);a["default"](r instanceof l.Poly),window.mapCanvas.removePoly(r),h["delete"](n)}),s.on(d.Drawing.event.COLOR_CHANGED,function(e,t){var n=t.color,r=t.context;a["default"](h.has(r));var i=h.get(r);i.setOptions({color:n});var o=r.nodes(),s=!0,u=!1,l=void 0;try{for(var d,f=o[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var c=d.value;a["default"](g.has(c));var v=g.get(c);v.setOptions({strokeColor:n})}}catch(p){u=!0,l=p}finally{try{!s&&f["return"]&&f["return"]()}finally{if(u)throw l}}}),s.on(d.Drawing.event.FILL_CHANGED,function(e,t){var r=(t.fill,t.context);a["default"](h.has(r));var i=n(r);h.set(r,i)}),s.on(d.Drawing.event.POINTS_ADDED,function(e,n){var r=n.atIndex,i=n.addedPoints,s=n.context;a["default"](h.has(s));var u=h.get(s),l=t(i);u.addLatLngs({atIndex:r,latLngs:l});var f=s.color,c=s.nodes(),v=i.length,y=s.fill&&r+v===s.length;i.forEach(function(e,t){if((!y||t!==v-1)&&e instanceof d.Node){var n=c.indexOf(e),i=o({point:e,color:f});window.mapCanvas.addMarker({atIndex:n,marker:i}),g.set(e,i),p.set(i,r+t)}})}),s.on(d.Drawing.event.POINTS_REMOVED,function(e,t){var n=t.start,r=t.end,i=t.removedPoints,o=t.context;a["default"](h.has(o));var s=h.get(o),u=i.length,l=o.fill&&r===o.length;s.removeLatLngs({start:n,end:r}),i.forEach(function(e,t){if((!l||t!==u)&&e instanceof d.Node){a["default"](g.has(e));var n=g.get(e);n.destroy(),g["delete"](e),p["delete"](n)}})}),s.on(d.Node.event.MOVED,function(t,n){var r=n.x,o=n.y,s=n.context;a["default"](s instanceof d.Node),a["default"](g.has(s));{var u=g.get(s);p.get(u)}u.setPosition(e(s));for(var l=h.entries(),f=void 0;f=l.next();){a["default"](!l.done,"Poly not found");var c=i(f.value,2),v=c[0],y=c[1],m=v.indexOf(s);if(m>-1){if(v.fill&&0===m){y.removeLatLngs({start:m,end:m+1}),y.removeLatLngs({start:y.length-1,end:y.length});var b=e({x:r,y:o});y.addLatLngs({atIndex:m,latLngs:[b]}),y.addLatLngs({atIndex:y.length,latLngs:[b]})}else y.removeLatLngs({start:m,end:m+1}),y.addLatLngs({atIndex:m,latLngs:[e({x:r,y:o})]});return}}}),s.on(l.MapCanvas.event.PRESSED,function(e,t){var n=t.event;return s.emit(f.event.MAP_PRESSED,n)}),s.on(l.Poly.event.PRESSED,function(e,t){var n=t.event,r=t.context;return s.emit(f.event.POLY_PRESSED,{latLng:n.latLng,node:v(r)})}),s.on(l.Marker.event.PRESSED,function(e,t){var n=t.event,r=t.context;return s.emit(f.event.MARKER_PRESSED,{latLng:n.latLng,node:c(r)})}),s.on(l.Marker.event.DRAGSTARTED,function(e,t){var n=t.event,r=t.context;return s.emit(f.event.MARKER_DRAGSTARTED,{latLng:n.latLng,node:c(r)})}),s.on(l.Marker.event.DRAGGED,function(e,t){for(var n=t.event,r=t.context,o=c(r),u=h.entries(),l=void 0;l=u.next();){a["default"](!u.done,"Poly not found");var d=i(l.value,2),v=d[0],g=d[1],p=v.indexOf(o);if(p>-1){if(v.fill&&0===p){g.removeLatLngs({start:p,end:p+1}),g.removeLatLngs({start:g.length-1,end:g.length});var y=r.getPosition();g.addLatLngs({atIndex:p,latLngs:[y]}),g.addLatLngs({atIndex:g.length,latLngs:[y]})}else g.removeLatLngs({start:p,end:p+1}),g.addLatLngs({atIndex:p,latLngs:[r.getPosition()]});return}}s.emit(f.event.MARKER_DRAGGED,{latLng:n.latLng,node:c(r)})}),s.on(l.Marker.event.DRAGENDED,function(e,t){var n=t.event,r=t.context;return s.emit(f.event.MARKER_DRAGENDED,{latLng:n.latLng,node:c(r)})})}},{"./assert":2,"./drawing-class":5,"./event-target":6,"./map-class":7,"./pubsub":9}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=PubSub.publishSync.bind(PubSub),i=PubSub.subscribe.bind(PubSub),o=PubSub.unsubscribe.bind(PubSub);n.emit=r,n.on=i,n.off=o},{}],10:[function(e,t,n){"use strict";var r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){r(this,e),this._q=Promise.resolve(!0)}return i(e,[{key:"add",value:function(e){return this._q=this._q.then(e),this}}]),e}();n["default"]=o,t.exports=n["default"]},{}]},{},[1]);
//# sourceMappingURL=sourcemaps/bundle.js.map